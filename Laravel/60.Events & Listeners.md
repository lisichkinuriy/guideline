# Events & Listeners

- Event регистрируется внутри доменных методов и диспетчится в момент коммита UnitOfWork.
- Event это всегда Доменный Event
- Event это способ передачи управления из одного модуля приложения в другой
- Общение между модулями происходит через очереди, поэтому Listener - всегда ShouldQueue. Listener = Job.
Listener это разрыв через очередь процесса выполнения кода. 
- Listener - это точка входа в Action 


Плохой пример
```php
$user->doSomething();
UserDid::dispatch();
```

Хороший пример
```php

$user->doSomething();
$uow->add($user)->commit();

trait UserDomain {
    public function doSomething(): self {
        echo "i did";
        $this->dispatchDomainEvent(UserDid::class, $this);
        return $this;
    }
}


```

Пример юнит теста
```php

    public function test_postback_listener(): void
    {
        Event::fake();
        Event::assertListening(CardIssueCreated::class, PostbackListener::class);
        Event::assertListening(CardIssueFailed::class, PostbackListener::class);
    }

```