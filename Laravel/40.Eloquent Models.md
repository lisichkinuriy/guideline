# Models

- используем трейт Domain
- используем интерфейс IDomainEntity
- НЕ указываем $fillable
- используем стандартные касты
- use HasVersion7Uuids;
- для используемых в коде строковых названий аттрибутов задаём константы



Плохой пример
```php

class Referral extends Model
{
    use HasVersion7Uuids;
        
    protected $fillable = [
        'vcc_service',
        'order_payload',
        'vcc_order_payload',
        'payment_id',
        'card_id',
        'available_card_id',
        'status',
        'ownerable_type',
        'ownerable_id',
    ];

    protected function casts(): array
    {
        return [
            'referrers' => 'array'
        ];
    }
    
    public function doSomething() {
        
    }
}
```

Хороший пример
```php
class Referral extends Model implements IDomainEntity
{
    use ReferralDomain;
    use HasVersion7Uuids;

    const string REFERRERS = 'referrers';

    protected function casts(): array
    {
        return [
            self::REFERRERS => 'array'
        ];
    }

}
```


Пример юнит теста
```php
class SenderCanMakePayoutsTest extends TestCase
{
    public static function senders(): array
    {
        return [
            [fn () => Sender::fakeTKassa(), true],
            [fn () => Sender::fakeSBPAcq(), false],
            [fn () => Sender::fakeSBPAcq()->fakePending(), false],
            [fn () => Sender::fakeSBPAcq()->fakeBroken(), false],
            [fn () => Sender::fakeSBPAcq()->fakeActive(), true],
        ];
    }

    #[DataProvider('senders')]
    public function test_can_make_payouts(
        Closure $sender_f,
        bool $expected
    ): void {
        /** @var Sender $sender */
        $sender = $sender_f();
        $result = $sender->canMakePayouts();
        $this->assertSame($expected, $result);
    }
}
```

