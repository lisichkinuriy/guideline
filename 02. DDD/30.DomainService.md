# DomainService

Некоторые операции требуют на входе множество Entity.  
Их реализуем в stateless классах DomainService  
сами операции - pure function, это позволяет писать unit тесты 

пример
```php
class DebtService
{
    /**
     * @param Collection<int, EmployeeRequisite> $active_requisites
     * @param Collection<int, Commission> $unpaid_commissions
     */
    public static function getPermissionDTO(
        Collection $active_requisites,
        Collection $unpaid_commissions,
        CommissionSettings $commissionSettings
    ): PayoutPermissionDTO {
        // Выплата запрещена если:
        // есть долг
        // расчёт комиссии включен, но реквизитов для выплаты нет

        if (false === $unpaid_commissions->isEmpty()) {
            return PayoutPermissionDTO::debt();
        }

        if ($commissionSettings->isActive()
            && $active_requisites->isEmpty()) {
            return PayoutPermissionDTO::noRequisites();
        }

        return PayoutPermissionDTO::allowed();
    }
}
```

пример юнит теста
```php
public function test_debt_domain_service()
{
    $permission = DebtService::getPermissionDTO(collect(), collect(), CommissionSettings::fake());
    $this->assertFalse($permission->isAllowed());
}
```
